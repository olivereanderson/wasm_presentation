#!/bin/bash
rm -f ./wasm_binaries/*.wasm
cd rust_wasm_square_free && cargo build --target wasm32-unknown-unknown --release && wasm-gc --no-demangle target/wasm32-unknown-unknown/release/rust_wasm_square_free.wasm -o ./rust_wasm_square_free.gc.wasm && wasm-opt -O3 --strip-producers ./rust_wasm_square_free.gc.wasm -o ./../wasm_binaries/rust_wasm_square_free.wasm && cp ./../wasm_binaries/rust_wasm_square_free.wasm  ./../html/is_square_free/rust_wasm_square_free.wasm && cd ./..
cd rust_wasm_fib && cargo build --target wasm32-unknown-unknown --release && wasm-gc --no-demangle target/wasm32-unknown-unknown/release/rust_wasm_fib.wasm -o ./rust_fib.gc.wasm && wasm-opt -O3 --strip-producers ./rust_fib.gc.wasm -o ./../wasm_binaries/rust_fib.wasm && cp ./../wasm_binaries/rust_fib.wasm ./../html/fibonacci/rust_fib.wasm && cd ./..
cd rust_wasm_greeting && cargo build --target wasm32-unknown-unknown --release && wasm-gc --no-demangle target/wasm32-unknown-unknown/release/rust_wasm_greeting.wasm -o ./rust_greeting.gc.wasm && wasm-opt -O3 --strip-producers ./rust_greeting.gc.wasm -o ./../wasm_binaries/rust_greeting.wasm && cd ./..
rm -f ./html/greetings/rust_wasm* && cd rust_wasm_browser_greeting &&  cargo build --target wasm32-unknown-unknown --release && wasm-bindgen target/wasm32-unknown-unknown/release/rust_wasm_browser_greeting.wasm  --target web --out-dir ./../html/greetings --no-typescript
